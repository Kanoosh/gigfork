(function(){var w=YAHOO.util.Dom,I=YAHOO.util.Event,G=YAHOO.util.DragDropMgr;var f=Alfresco.util.encodeHTML,ag=Alfresco.util.activateLinks,aA=Alfresco.util.combinePaths,m=Alfresco.util.userProfileLink,b=Alfresco.util.siteURL,H=function H(aS,aT){return Alfresco.util.formatDate(Alfresco.util.fromISO8601(aS),aT)},X=Alfresco.util.relativeTime,A=Alfresco.util.isValueSet;var aL="org.alfresco.share.documentList",ax=aL+".sortAscending",d=aL+".sortField",T=aL+".showFolders",M=aL+".simpleView",V=aL+".viewRendererName";Alfresco.DnD=function(aW,aT,aS,aU){Alfresco.DnD.superclass.constructor.call(this,aW,aS,aU);var aV=this.getDragEl();w.setStyle(aV,"opacity",0.67);this.docLib=aT};YAHOO.extend(Alfresco.DnD,YAHOO.util.DDProxy,{_inFlight:false,startDrag:function n(aT,aW){var aS=this.getDragEl();var aV=this.getEl();w.setStyle(aV,"visibility","hidden");var aU=document.createElement("img");aU.src=aV.src;aS.removeChild(aS.firstChild);aS.appendChild(aU);w.setStyle(aS,"border","none")},endDrag:function ae(aU){if(!this._inFlight){var aS=this.getEl();var aT=this.getDragEl();this.animateResult(aT,aS)}},animateResult:function al(aV,aS){w.setStyle(aV,"visibility","");var aT=new YAHOO.util.Motion(aV,{points:{to:w.getXY(aS)}},0.2,YAHOO.util.Easing.easeOut);var aU=aV.id;var aW=this.id;aT.onComplete.subscribe(function(){w.setStyle(aU,"visibility","hidden");w.setStyle(aW,"visibility","")});aT.animate()},onDragDrop:function r(aW,aY){var aX=w.get(aY);if(G.interactionInfo.drop.length>0){if(w.isAncestor(this.docLib.widgets.dataTable.getContainerEl(),aX)){var aS=this.docLib.widgets.dataTable.getRecord(w.get(aY)),aV=aS.getData();if(aV.node.isContainer){this._inFlight=true;var aT;if(aV.node.isLink){aT=new Alfresco.util.NodeRef(aV.node.linkedNode.nodeRef)}else{aT=new Alfresco.util.NodeRef(aV.node.nodeRef)}this._performMove(aT,aV.location.path+"/"+aV.location.file)}}else{if(w.hasClass(aX,"documentDroppable")){var aU={elementId:aY,callback:this.onDropTargetOwnerCallBack,scope:this};this._inFlight=true;YAHOO.Bubbling.fire("dropTargetOwnerRequest",aU);this._setFailureTimeout()}}}},_performMove:function ak(aX,a0){var aU=this.docLib.widgets.dataTable.getRecord(this.getEl()),aV="move-to/node/{nodeRef}",aZ=[];aZ.push(this.getEl().id);var aY=function aW(a3){this._inFlight=false;var a1,a4=a3.json.successCount,a5=a3.json.failureCount;if(!a3.json.overallSuccess){this.animateResult(this.getDragEl(),this.getEl());Alfresco.util.PopupManager.displayMessage({text:this.docLib.msg("message.file-dnd-move.failure")});w.removeClass(this.dragFolderHighlight,"dndFolderHighlight");return}this.docLib._updateDocList.call(this.docLib);var a2=aU.getData();if(a2.node.isContainer){YAHOO.Bubbling.fire("folderMoved",{multiple:true,nodeRef:a2.nodeRef,destination:a0})}};var aT=function aS(a1){this._inFlight=false;this.animateResult(this.getDragEl(),this.getEl());Alfresco.util.PopupManager.displayMessage({text:this.docLib.msg("message.file-dnd-move.failure")});w.removeClass(this.dragFolderHighlight,"dndFolderHighlight")};this.docLib.modules.actions.genericAction({success:{callback:{fn:aY,scope:this}},failure:{callback:{fn:aT,scope:this}},webscript:{method:Alfresco.util.Ajax.POST,name:aV,params:{nodeRef:aX.uri}},wait:{message:this.docLib.msg("message.please-wait")},config:{requestContentType:Alfresco.util.Ajax.JSON,dataObj:{nodeRefs:aZ,parentId:this.docLib.doclistMetadata.parent.nodeRef}}})},_currTimeoutId:null,onDropTargetOwnerCallBack:function ap(aS,aU){this._clearTimeout();var aT=new Alfresco.util.NodeRef(aS);this._performMove(aT,aU)},_clearTimeout:function af(){if(this._currTimeoutId!=null){window.clearTimeout(this._currTimeoutId);this._currTimeoutId=null;this._inFlight=false}},_setFailureTimeout:function aD(){this._clearTimeout();var aS=this;this._currTimeoutId=window.setTimeout(function(){aS.animateResult(aS.getDragEl(),aS.getEl());aS._inFlight=false;aS._currTimeoutId=null},500)},onDragOver:function aO(aU,aV){var aS=w.get(aV);if(aS.tagName=="IMG"||aS.className=="droppable"){this.dragFolderHighlight=w.getAncestorByClassName(aS,"folder");w.addClass(this.dragFolderHighlight,"dndFolderHighlight")}else{if(w.hasClass(aS,"documentDroppableHighlights")){var aT={elementId:aV,event:aU};YAHOO.Bubbling.fire("documentDragOver",aT)}}},onDragOut:function aE(aU,aV){var aS=w.get(aV);if(aS.tagName=="IMG"||aS.className=="droppable"){this.dragFolderHighlight=w.getAncestorByClassName(aS,"folder");w.removeClass(this.dragFolderHighlight,"dndFolderHighlight")}else{if(w.hasClass(aS,"documentDroppableHighlights")){var aT={elementId:aV,event:aU};YAHOO.Bubbling.fire("documentDragOut",aT)}}}});Alfresco.DocumentListViewRenderer=function(aS){this.name=aS;this.parentElementIdSuffix="-documents";this.actionsCssClassName=this.name;this.actionsColumnWidth=200;this.thumbnailColumnWidth=100;this.buttonElementIdSuffix="-"+this.name+"View";this.buttonCssClass=this.name+"-view";return this};Alfresco.DocumentListViewRenderer.prototype={setupRenderer:function O(aS){w.addClass(aS.id+this.buttonElementIdSuffix,this.buttonCssClass)},renderView:function ao(aU,aS,aT,aV){YAHOO.util.Dom.setStyle(aU.id+this.parentElementIdSuffix,"display","");aU.widgets.dataTable.onDataReturnInitializeTable.call(aU.widgets.dataTable,aS,aT,aV)},destroyView:function av(aU,aS,aT,aV){YAHOO.util.Dom.setStyle(aU.id+this.parentElementIdSuffix,"display","none")},renderCellThumbnail:function U(a5,a4,a6,a0,aW){var aZ=a6.getData(),aX=aZ.jsNode,a2=aX.properties,aT=aZ.displayName,aV=aX.isContainer,aY=aX.isLink,a1=aT.substring(aT.lastIndexOf(".")),aS=aX.nodeRef.nodeRef;var a3;a0.width=this.thumbnailColumnWidth;w.setStyle(a4,"width",a0.width+"px");w.setStyle(a4.parentNode,"width",a0.width+"px");if(aV||(aY&&aX.linkedNode.isContainer)){a4.innerHTML='<span class="folder">'+(aY?'<span class="link"></span>':"")+(a5.dragAndDropEnabled?'<span class="droppable"></span>':"")+Alfresco.DocumentList.generateFileFolderLinkMarkup(a5,aZ)+'<img id="'+aS+'" src="'+Alfresco.constants.URL_RESCONTEXT+'components/documentlibrary/images/folder-64.png" /></a>';a3=new YAHOO.util.DDTarget(aS)}else{a4.innerHTML='<span class="thumbnail">'+(aY?'<span class="link"></span>':"")+Alfresco.DocumentList.generateFileFolderLinkMarkup(a5,aZ)+'<img id="'+aS+'" src="'+Alfresco.DocumentList.generateThumbnailUrl(aZ)+'" alt="'+a1+'" title="'+f(aT)+'" /></a></span>'}var aU=new Alfresco.DnD(aS,a5)}};Alfresco.DocumentList=function(aS){Alfresco.DocumentList.superclass.constructor.call(this,"Alfresco.DocumentList",aS,["button","menu","container","datasource","datatable","paginator","json","history"]);this.currentPath="";this.currentPage=1;this.totalRecords=0;this.totalRecordsUpper=null;this.showingMoreActions=false;this.state={actionEditOfflineActive:false};this.currentFilter={filterId:"path",filterData:""};this.actions={};this.selectedFiles={};this.afterDocListUpdate=[];this.doclistMetadata={};this.previewTooltips=[];this.insituEditors=[];this.dynamicControls=[];this.dragAndDropAllowed=true;this.dragAndDropEnabled=false;this.dragEventRefCount=0;this.actionsView="browse";this.renderers={};this.viewRenderers={};this.dataSourceUrl=aA(Alfresco.constants.URL_SERVICECONTEXT,"components/documentlibrary/data/doclist/");YAHOO.Bubbling.on("activateDynamicControls",this.onActivateDynamicControls,this);YAHOO.Bubbling.on("deactivateAllControls",this.onDeactivateAllControls,this);YAHOO.Bubbling.on("deactivateDynamicControls",this.onDeactivateDynamicControls,this);YAHOO.Bubbling.on("metadataRefresh",this.onDocListRefresh,this);YAHOO.Bubbling.on("fileRenamed",this.onFileRenamed,this);YAHOO.Bubbling.on("changeFilter",this.onChangeFilter,this);YAHOO.Bubbling.on("filterChanged",this.onFilterChanged,this);YAHOO.Bubbling.on("folderCreated",this.onDocListRefresh,this);YAHOO.Bubbling.on("nodeCreated",this.onDocListRefresh,this);YAHOO.Bubbling.on("folderRenamed",this.onFileRenamed,this);YAHOO.Bubbling.on("highlightFile",this.onHighlightFile,this);YAHOO.Bubbling.on("registerRenderer",this.onRegisterRenderer,this);YAHOO.Bubbling.on("registerViewRenderer",this.onRegisterViewRenderer,this);YAHOO.Bubbling.on("registerAction",this.onRegisterAction,this);YAHOO.Bubbling.on("fileCopied",this.onFileAction,this);YAHOO.Bubbling.on("fileDeleted",this.onFileAction,this);YAHOO.Bubbling.on("fileMoved",this.onFileAction,this);YAHOO.Bubbling.on("filePermissionsUpdated",this.onFileAction,this);YAHOO.Bubbling.on("folderCopied",this.onFileAction,this);YAHOO.Bubbling.on("folderDeleted",this.onFileAction,this);YAHOO.Bubbling.on("folderMoved",this.onFileAction,this);YAHOO.Bubbling.on("folderPermissionsUpdated",this.onFileAction,this);YAHOO.Bubbling.on("filesCopied",this.onDocListRefresh,this);YAHOO.Bubbling.on("filesDeleted",this.onDocListRefresh,this);YAHOO.Bubbling.on("filesMoved",this.onDocListRefresh,this);YAHOO.Bubbling.on("filesPermissionsUpdated",this.onDocListRefresh,this);return this};YAHOO.extend(Alfresco.DocumentList,Alfresco.component.Base);YAHOO.lang.augmentProto(Alfresco.DocumentList,Alfresco.doclib.Actions);Alfresco.DocumentList.generateFilterMarkup=function s(aS){var aT=Alfresco.util.cleanBubblingObject(aS);return YAHOO.lang.substitute("{filterOwner}|{filterId}|{filterData}|{filterDisplay}",aT,function(aV,aW,aU){return typeof aW==="undefined"?"":window.escape(aW)})};Alfresco.DocumentList.generatePathMarkup=function ah(aS){return Alfresco.DocumentList.generateFilterMarkup({filterId:"path",filterData:aA(aS.path,aS.file)})};Alfresco.DocumentList.generateCategoryMarkup=function i(aS){return Alfresco.DocumentList.generateFilterMarkup({filterId:"category",filterData:aA(aS[1],aS[0])})};Alfresco.DocumentList.generateFileFolderLinkMarkup=function g(aU,aS){var aV=aS.jsNode,aT;if(aV.isLink&&A(aU.options.siteId)&&aS.location.site&&aS.location.site.name!==aU.options.siteId){if(aV.isContainer){aT=b("documentlibrary?path="+encodeURIComponent(aS.location.path),{site:aS.location.site.name})}else{aT=aU.getActionUrls(aS,aS.location.site.name).documentDetailsUrl}}else{if(aV.isContainer){aT='#" class="filter-change" rel="'+Alfresco.DocumentList.generatePathMarkup(aS.location)}else{aT=aU.getActionUrls(aS).documentDetailsUrl}}return'<a href="'+aT+'">'};Alfresco.DocumentList.generateThumbnailUrl=function Z(aS,aV){var aU=aS.jsNode,aT=aU.isLink?aU.linkedNode.nodeRef:aU.nodeRef;if(aV==null){aV="doclib"}return Alfresco.constants.PROXY_URI+"api/node/"+aT.uri+"/content/thumbnails/doclib?c=queue&ph=true"};Alfresco.DocumentList.generateFavourite=function aB(aU,aS){var aV=aS.jsNode,aW="favourite."+(aV.isContainer?"folder.":"document."),aT="";if(aS.isFavourite){aT='<a class="favourite-action enabled" title="'+aU.msg(aW+"remove.tip")+'" tabindex="0"></a>'}else{aT='<a class="favourite-action" title="'+aU.msg(aW+"add.tip")+'" tabindex="0">'+aU.msg(aW+"add.label")+"</a>"}return aT};Alfresco.DocumentList.generateLikes=function o(aV,aS){var aW=aS.node,aT=aS.likes,aX="like."+(aW.isContainer?"folder.":"document."),aU="";if(aT.isLiked){aU='<a class="like-action enabled" title="'+aV.msg(aX+"remove.tip")+'" tabindex="0"></a>'}else{aU='<a class="like-action" title="'+aV.msg(aX+"add.tip")+'" tabindex="0">'+aV.msg(aX+"add.label")+"</a>"}aU+='<span class="likes-count">'+f(aT.totalLikes)+"</span>";return aU};Alfresco.DocumentList.generateComments=function aF(aV,aS){var aX=aS.node,aW=aV.getActionUrls(aS),aT=aW[aX.isContainer?"folderDetailsUrl":"documentDetailsUrl"]+"#comment",aY="comment."+(aX.isContainer?"folder.":"document.");var aU='<a href="'+aT+'" class="comment" title="'+aV.msg(aY+"tip")+'" tabindex="0">'+aV.msg(aY+"label")+"</a>";if(aX.properties["fm:commentCount"]!==undefined){aU+='<span class="comment-count">'+f(aX.properties["fm:commentCount"])+"</span>"}return aU};Alfresco.DocumentList.generateUserLink=function aI(aT,aS){if(aS.isDeleted===true){return"<span>"+aT.msg("details.user.deleted",f(aS.userName))+"</span>"}return m(aS.userName,YAHOO.lang.trim(aS.firstName+" "+aS.lastName))};YAHOO.lang.augmentObject(Alfresco.DocumentList.prototype,{options:{sortAscending:true,showFolders:false,simpleView:null,viewRendererName:"detailed",viewRendererNames:["simple","detailed"],usePagination:false,siteId:"",containerId:"documentLibrary",rootNode:null,initialPage:1,pageSize:50,initialFilter:{},actionsPopupTimeout:700,loadingMessageDelay:1000,highlightFile:null,previewTooltips:null,insituEditors:null,groupActivitiesAt:5,inlineEditMimetypes:{"text/plain":true,"text/html":true,"text/xml":true},replicationUrlMapping:{},listUpdated:false,repositoryBrowsing:true,useTitle:true,userIsSiteManager:false,actionsSplitAt:3},state:{actionEditOfflineActive:false},currentPath:null,currentPage:null,totalRecords:null,currentFilter:null,fileUpload:null,actions:null,selectedFiles:null,currentActionsMenu:null,showingMoreActions:null,deferredActionsMenu:null,afterDocListUpdate:null,doclistMetadata:null,dynamicControls:null,dragAndDropAllowed:null,dragAndDropEnabled:null,dragEventRefCount:null,dragFolderHighlight:null,renderers:null,viewRenderers:null,onReady:function Q(){var a4=this;this.dragAndDropEnabled=this.dragAndDropAllowed&&("draggable" in document.createElement("span"))&&YAHOO.env.ua.mobile===null;var aY=false;var aV=1;for(var aX=0,a7=this.options.viewRendererNames.length;aX<a7;aX++){if(this.options.viewRendererNames[aX]===this.options.viewRendererName){aY=true;aV=aX;break}}if(!aY){this.options.viewRendererName=this.options.viewRendererNames[1]}this._setupMetadataRenderers();this._setupHistoryManagers();this.widgets.sortAscending=Alfresco.util.createYUIButton(this,"sortAscending-button",this.onSortAscending);if(this.widgets.sortAscending!==null){this.widgets.sortAscending.set("title",this.msg(this.options.sortAscending?"button.sort.descending":"button.sort.ascending"));if(!this.options.sortAscending){w.addClass(this.widgets.sortAscending.get("element"),"sort-descending")}this.dynamicControls.push(this.widgets.sortAscending)}this.widgets.sortField=Alfresco.util.createYUIButton(this,"sortField-button",this.onSortField,{type:"menu",menu:"sortField-menu",lazyloadmenu:false});if(this.widgets.sortField!==null){this.dynamicControls.push(this.widgets.sortField);var aT=this.widgets.sortField.getMenu().getItems(),aZ;for(aZ in aT){if(aT.hasOwnProperty(aZ)){if(aT[aZ].value===this.options.sortField){this.widgets.sortField.set("label",aT[aZ].cfg.getProperty("text"));break}}}}this.widgets.showFolders=Alfresco.util.createYUIButton(this,"showFolders-button",this.onShowFolders,{type:"checkbox",checked:this.options.showFolders});if(this.widgets.showFolders!==null){this.widgets.showFolders.set("title",this.msg(this.options.showFolders?"button.folders.hide":"button.folders.show"));this.dynamicControls.push(this.widgets.showFolders)}this.widgets.viewRendererSelect=new YAHOO.widget.ButtonGroup(this.id+"-simpleDetailed");if(this.widgets.viewRendererSelect!==null){this.widgets.viewRendererSelect.check(aV);this.widgets.viewRendererSelect.on("checkedButtonChange",this.onViewRendererSelect,this.widgets.viewRendererSelect,this);this.dynamicControls.push(this.widgets.viewRendererSelect)}this.widgets.fileSelect=Alfresco.util.createYUIButton(this,"fileSelect-button",this.onFileSelect,{type:"menu",menu:"fileSelect-menu"});if(this.widgets.fileSelect!==null){this.dynamicControls.push(this.widgets.fileSelect)}this._setupViewRenderers();this.services.preferences=new Alfresco.service.Preferences();this.services.likes=new Alfresco.service.Ratings(Alfresco.service.Ratings.LIKES);this._setupDataSource();this._setupDataTable();this.widgets.previewTooltip=new YAHOO.widget.Tooltip(this.id+"-previewTooltip",{width:"108px"});this.widgets.previewTooltip.contextTriggerEvent.subscribe(function(bb,a9){var ba=a9[0],bc=a4.widgets.dataTable.getRecord(ba.id),a8=bc.getData();this.cfg.setProperty("text",'<img src="'+Alfresco.DocumentList.generateThumbnailUrl(a8)+'" />')});var a6=function aU(bb,ba){var a8=YAHOO.Bubbling.getOwnerByTagName(ba[1].anchor,"div");if(a8!==null){if(typeof a4[a8.title]==="function"){ba[1].stop=true;var a9=a4.widgets.dataTable.getRecord(ba[1].target.offsetParent).getData();a4[a8.title].call(a4,a9,a8)}}return true};YAHOO.Bubbling.addDefaultAction("action-link",a6);YAHOO.Bubbling.addDefaultAction("show-more",a6);var a2=function a5(ba,a9){var a8=YAHOO.Bubbling.getOwnerByTagName(a9[1].anchor,"div");if(a8!==null){a4.onLikes.call(a4,a9[1].target.offsetParent,a8)}return true};YAHOO.Bubbling.addDefaultAction("like-action",a2);var a1=function aS(ba,a9){var a8=YAHOO.Bubbling.getOwnerByTagName(a9[1].anchor,"div");if(a8!==null){a4.onFavourite.call(a4,a9[1].target.offsetParent,a8)}return true};YAHOO.Bubbling.addDefaultAction("favourite-action",a1);var a3=function aW(ba,a9){var a8=a9[1].anchor;if(a8!==null){var bb=a8.rel,bc,bd={};if(bb&&bb!==""){a9[1].stop=true;bc=bb.split("|");bd={filterOwner:window.unescape(bc[0]||""),filterId:window.unescape(bc[1]||""),filterData:window.unescape(bc[2]||""),filterDisplay:window.unescape(bc[3]||"")};Alfresco.logger.debug("DL_fnChangeFilterHandler","changeFilter =>",bd);YAHOO.Bubbling.fire("changeFilter",bd)}}return true};YAHOO.Bubbling.addDefaultAction("filter-change",a3);this.modules.actions=new Alfresco.module.DoclibActions();YAHOO.util.History.onReady(this.onHistoryManagerReady,this,true);try{YAHOO.util.History.initialize("yui-history-field","yui-history-iframe")}catch(a0){Alfresco.logger.error(this.name+": Couldn't initialize HistoryManager.",a0);this.onHistoryManagerReady()}YAHOO.Bubbling.fire("postDocumentListOnReady",{scope:this,eventGroup:this.id})},_insituCallback:function ai(aU,aT){var aX=aT.jsNode,aW=aX.nodeRef;Alfresco.util.Ajax.request({url:Alfresco.constants.URL_SERVICECONTEXT+"components/documentlibrary/data/node/"+aW.uri+"?filter="+encodeURIComponent(this.currentFilter.filterId)+"&view="+this.actionsView+"&noCache="+new Date().getTime(),successCallback:{fn:function aS(aY){aY.json.item.jsNode=new Alfresco.util.Node(aY.json.item.node);YAHOO.Bubbling.fire(aX.isContainer?"folderRenamed":"fileRenamed",{file:aY.json.item});return false},scope:this},failureCallback:{fn:function aV(aY){},scope:this}})},fnRenderCellSelected:function au(){var aS=this;return function aT(aX,aW,aY,aZ){w.setStyle(aX,"width",aY.width+"px");w.setStyle(aX.parentNode,"width",aY.width+"px");var aV=aW.getData("jsNode"),aU=aV.nodeRef;aX.innerHTML='<input id="checkbox-'+aW.getId()+'" type="checkbox" name="fileChecked" value="'+aU+'"'+(aS.selectedFiles[aU]?' checked="checked">':">")}},fnRenderCellStatus:function K(){var aS=this;return function aT(a2,a5,aZ,aU){w.setStyle(a2,"width",aZ.width+"px");w.setStyle(a2.parentNode,"width",aZ.width+"px");var aX=a5.getData(),aV=aX.jsNode,a1=aX.indicators,a3,a0,aY="";if(a1&&a1.length>0){for(var aW=0,a4=a1.length;aW<a4;aW++){a3=a1[aW];a0=Alfresco.util.message(a3.label,aS.name,a3.labelParams);a0=Alfresco.util.substituteDotNotation(a0,aX);aY+='<div class="status"><img src="'+Alfresco.constants.URL_RESCONTEXT+"components/documentlibrary/indicators/"+a3.icon+'" title="'+a0+'" alt="'+a3.id+'" /></div>'}}a2.innerHTML=aY}},fnRenderCellThumbnail:function aM(){var aS=this;return function aT(aV,aU,aW,aX){if(typeof aS.viewRenderers[aS.options.viewRendererName]==="object"){aS.viewRenderers[aS.options.viewRendererName].renderCellThumbnail(aS,aV,aU,aW,aX)}}},fnRenderCellDescription:function aJ(){var aS=this;return function aT(aZ,bg,a5,ba){var bd="",bc,bb,aW=bg.getData(),be=aW.jsNode,a0=be.properties,a1=be.isContainer,a2=be.isLink,bk="",a8="",aX="",aY=be.permissions.user.CreateChildren;if(be.isLink){bg.setData("displayName",aS.msg("details.link-to",aW.location.file))}else{if(a0.title&&a0.title!==aW.displayName&&aS.options.useTitle){a8='<span class="title">('+f(a0.title)+")</span>"}}if(A(aW.version)&&!be.isContainer&&!be.isLink){aX='<span class="document-version">'+f(aW.version)+"</span>"}aW._filenameId=Alfresco.util.generateDomId();var a9=aW.metadataTemplate;if(a9){if(YAHOO.lang.isArray(a9.banners)){var bi=function aV(bn,bp,bm){var bl=(bm!==null?aS.msg(bm)+": ":""),bo="";if(aS.renderers.hasOwnProperty(bn)&&typeof aS.renderers[bn]==="function"){bo=aS.renderers[bn].call(aS,aW,bl)}else{if(be.hasProperty(bn)){bo='<span class="item">'+bl+f(be.properties[bn])+"</span>"}}return bo};var a7,bj;for(bc=0,bb=a9.banners.length;bc<bb;bc++){bj=a9.banners[bc];if(!A(bj.view)||bj.view==aS.options.viewRendererName){a7=YAHOO.lang.substitute(bj.template,aS.renderers,bi);if(A(a7)){bd+='<div class="info-banner">'+a7+"</div>"}}}}if(YAHOO.lang.isString(a9.title)){var bf=function aU(bn,bp,bm){var bl=(bm!==null?"<em>"+aS.msg(bm)+"</em>: ":""),bo="";if(aS.renderers.hasOwnProperty(bn)&&typeof aS.renderers[bn]==="function"){bo=aS.renderers[bn].call(aS,aW,bl)}else{if(be.hasProperty(bn)){bo='<div class="filename">'+Alfresco.DocumentList.generateFileFolderLinkMarkup(aS,aW);bo+=bl+f(be.properties[bn])+"</a></span></div>"}}return bo};bd+=YAHOO.lang.substitute(a9.title,aS.renderers,bf)}else{if(be.hasPermission("Write")&&!be.isLocked){aS.insituEditors.push({context:aW._filenameId,params:{type:"textBox",nodeRef:be.nodeRef.toString(),name:"prop_cm_name",value:aW.fileName,fnSelect:function a4(bm,bn){var bl=bn.lastIndexOf(Alfresco.util.getFileExtension(bn))-1;if(bl>0){Alfresco.util.selectText(bm,0,bl)}else{bm.select()}},validations:[{type:Alfresco.forms.validation.nodeName,when:"keyup",message:aS.msg("validation-hint.nodeName")},{type:Alfresco.forms.validation.length,args:{min:1,max:255,crop:true},when:"keyup",message:aS.msg("validation-hint.length.min.max",1,255)}],title:aS.msg("tip.insitu-rename"),errorMessage:aS.msg("message.insitu-edit.name.failure")},callback:{fn:aS._insituCallback,scope:aS,obj:aW}})}bd+='<h3 class="filename"><span id="'+aW._filenameId+'">'+Alfresco.DocumentList.generateFileFolderLinkMarkup(aS,aW);bd+=f(aW.displayName)+"</a></span>"+a8+aX+"</h3>"}if(YAHOO.lang.isArray(a9.lines)){var bh=function a3(bn,bp,bm){var bl=(bm!==null?"<em>"+aS.msg(bm)+"</em>: ":""),bo="";if(aS.renderers.hasOwnProperty(bn)&&typeof aS.renderers[bn]==="function"){bo=aS.renderers[bn].call(aS,aW,bl)}else{if(be.hasProperty(bn)){bo='<span class="item">'+bl+f(be.properties[bn])+"</span>"}}return bo};var a7,a6;for(bc=0,bb=a9.lines.length;bc<bb;bc++){a6=a9.lines[bc];if(!A(a6.view)||a6.view==aS.options.viewRendererName){a7=YAHOO.lang.substitute(a6.template,aS.renderers,bh);if(A(a7)){bd+='<div class="detail">'+a7+"</div>"}}}}}aZ.innerHTML=bd}},fnRenderCellActions:function aN(){var aT=this;return function aS(aV,aU,aW,aX){if(typeof aT.viewRenderers[aT.options.viewRendererName]==="object"){aW.width=aT.viewRenderers[aT.options.viewRendererName].actionsColumnWidth}w.setStyle(aV,"width",aW.width+"px");w.setStyle(aV.parentNode,"width",aW.width+"px");w.addClass(aV.parentNode,aU.getData("type"));aV.innerHTML='<div id="'+aT.id+"-actions-"+aU.getId()+'" class="hidden"></div>'}},onRegisterRenderer:function L(aT,aS){var aU=aS[1];if(aU&&A(aU.propertyName)&&A(aU.renderer)){this.registerRenderer(aU.propertyName,aU.renderer)}else{Alfresco.logger.error("DL_onRegisterRenderer: Custom renderer registion invalid: "+aU)}},onRegisterViewRenderer:function l(aT,aS){var aU=aS[1];if(aU&&A(aU.renderer)){this.registerViewRenderer(aU.renderer)}else{Alfresco.logger.error("DL_onRegisterViewRenderer: Custom view renderer registion invalid: "+aU)}},registerRenderer:function ay(aS,aT){if(A(aS)&&A(aT)){this.renderers[aS]=aT;return true}return false},registerViewRenderer:function J(aS){if(A(aS)){this.viewRenderers[aS.name]=aS;this.viewRenderers[aS.name].setupRenderer(this);return true}return false},_setupMetadataRenderers:function x(){this.registerRenderer("i18nLabel",function(aS,aT){return aT.replace(/:\s$/,"")});this.registerRenderer("lockBanner",function(aS,aU){var aW=aS.jsNode.properties,aX=aW.lockOwner||aW.workingCopyOwner,aT=Alfresco.DocumentList.generateUserLink(this,aX),aV="";if(aS.workingCopy&&A(aS.workingCopy.googleDocUrl)){if(aX.userName===Alfresco.constants.USERNAME){aV=this.msg("details.banner.google-docs-owner",'<a href="'+aS.workingCopy.googleDocUrl+'" target="_blank">'+this.msg("details.banner.google-docs.link")+"</a>")}else{aV=this.msg("details.banner.google-docs-locked",aT,'<a href="'+aS.workingCopy.googleDocUrl+'" target="_blank">'+this.msg("details.banner.google-docs.link")+"</a>")}}else{if(aS.workingCopy&&aX.userName===Alfresco.constants.USERNAME){aV=this.msg("details.banner."+(aS.workingCopy.isWorkingCopy?"editing":"lock-owner"))}else{aV=this.msg("details.banner.locked",aT)}}return aV});this.registerRenderer("date",function(aS,aT){var aX=aS.jsNode,aV=aX.properties,aU="";var aW="modified",aY=aV.modified.iso8601;if(aS.workingCopy&&aS.workingCopy.isWorkingCopy){aW="editing-started"}else{if(aY===aV.created.iso8601){aW="created"}}aU='<span class="item">'+aT+this.msg("details."+aW+"-by",X(aY),Alfresco.DocumentList.generateUserLink(this,aV.modifier))+"</span>";return aU});this.registerRenderer("size",function(aS,aT){var aW=aS.jsNode,aV=aW.properties,aU="";if(!aW.isContainer&&!aW.isLink){aU+='<span class="item">'+aT+Alfresco.util.formatFileSize(aW.size)+"</span>"}return aU});this.registerRenderer("description",function(aS,aT){var aW=aS.jsNode,aV=aW.properties,aX=Alfresco.util.generateDomId(),aU='<span id="'+aX+'" class="faded">'+aT+this.msg("details.description.none")+"</span>";if(aV.description&&aV.description!==""){aU='<span id="'+aX+'" class="item">'+aT+ag(f(aV.description))+"</span>"}return aU});this.registerRenderer("tags",function(aX,aZ){var aT=aX.jsNode,aY=aT.properties,aS=Alfresco.util.generateDomId(),aW="";var a0=aT.tags,a1;if(aT.hasAspect("cm:taggable")&&a0.length>0){for(var aV=0,aU=a0.length;aV<aU;aV++){a1=f(a0[aV]);aW+='<span class="tag"><a href="#" class="tag-link" rel="'+a1+'">'+a1+"</a></span>"}}else{aW+='<span class="faded">'+aZ+this.msg("details.tags.none")+"</span>"}if(aT.hasPermission("Write")&&!aT.isLocked){this.insituEditors.push({context:aS,params:{type:"tagEditor",nodeRef:aT.nodeRef.toString(),name:"prop_cm_taggable",value:aX.node.properties["cm:taggable"],validations:[{type:Alfresco.forms.validation.nodeName,when:"keyup",message:this.msg("validation-hint.nodeName")}],title:this.msg("tip.insitu-tag"),errorMessage:this.msg("message.insitu-edit.tag.failure")},callback:{fn:this._insituCallback,scope:this,obj:aX}})}return'<span id="'+aS+'" class="item">'+aZ+aW+"</span>"});this.registerRenderer("categories",function(aY,a0){var aS=aY.jsNode,aZ=aS.properties,aW="";if(aS.hasAspect("cm:generalclassifiable")){var aX=aS.categories,aT;aW+='<span class="category-item item">&nbsp;</span><span class="item">'+a0;if(aX.length>0){for(var aV=0,aU=aX.length;aV<aU;aV++){aT=aX[aV];aW+='<span class="category"><a href="#" class="filter-change" rel="'+Alfresco.DocumentList.generateCategoryMarkup(aT)+'">'+f(aT[0])+"</a></span>"+(aU-aV>1?", ":"")}}else{aW+='<span class="faded">'+a0+this.msg("details.categories.none")+"</span>"}aW+="</span>"}return aW});this.registerRenderer("social",function(aS){var aV=aS.jsNode,aU=aV.properties,aT="";aT+='<span class="item item-social">'+Alfresco.DocumentList.generateFavourite(this,aS)+"</span>";aT+='<span class="item item-social item-separator">'+Alfresco.DocumentList.generateLikes(this,aS)+"</span>";if(aV.permissions.user.CreateChildren){aT+='<span class="item item-social item-separator">'+Alfresco.DocumentList.generateComments(this,aS)+"</span>"}return aT})},_setupViewRenderers:function P(){var aT=new Alfresco.DocumentListViewRenderer("simple");aT.actionsColumnWidth=80;aT.renderCellThumbnail=function aS(a8,a7,a9,a3,aZ){var a2=a9.getData(),a0=a2.jsNode,a5=a0.properties,aV=a2.displayName,aY=a0.isContainer,a1=a0.isLink,a4=aV.substring(aV.lastIndexOf(".")),aU=a0.nodeRef.nodeRef;var a6;a3.width=40;w.setStyle(a7,"width",a3.width+"px");w.setStyle(a7.parentNode,"width",a3.width+"px");if(aY){a7.innerHTML='<span class="folder-small">'+(a1?'<span class="link"></span>':"")+(a8.dragAndDropEnabled?'<span class="droppable"></span>':"")+Alfresco.DocumentList.generateFileFolderLinkMarkup(a8,a2)+'<img id="'+aU+'" src="'+Alfresco.constants.URL_RESCONTEXT+'components/documentlibrary/images/folder-32.png" /></a>';a6=new YAHOO.util.DDTarget(aU)}else{var aX=a8.id+"-preview-"+a9.getId();a7.innerHTML='<span id="'+aX+'" class="icon32">'+(a1?'<span class="link"></span>':"")+Alfresco.DocumentList.generateFileFolderLinkMarkup(a8,a2)+'<img id="'+aU+'" src="'+Alfresco.constants.URL_RESCONTEXT+"components/images/filetypes/"+Alfresco.util.getFileIcon(aV)+'" alt="'+a4+'" title="'+f(aV)+'" /></a></span>';a8.previewTooltips.push(aX)}var aW=new Alfresco.DnD(aU,a8)};this.registerViewRenderer(aT);this.registerViewRenderer(new Alfresco.DocumentListViewRenderer("detailed"))},_setupHistoryManagers:function aq(){var aV=YAHOO.util.History.getBookmarkedState("filter");aV=aV||"path|/";try{while(aV!==(aV=decodeURIComponent(aV))){}}catch(aY){}var aT=function a0(a1){var a2=a1.split("|"),a3={filterId:window.unescape(a2[0]||"")};if(typeof a2[1]!=="undefined"){a3.filterData=window.unescape(a2[1])}if(typeof a2[2]!=="undefined"){a3.filterDisplay=window.unescape(a2[2])}a3.filterOwner=Alfresco.util.FilterManager.getOwner(a3.filterId);return a3};this.options.initialFilter=aT(aV);YAHOO.util.History.register("filter",aV,function aS(a1){Alfresco.logger.debug("HistoryManager: filter changed:"+a1);if(YAHOO.env.ua.gecko>0){a1=window.unescape(a1);Alfresco.logger.debug("HistoryManager: filter (after Firefox fix):"+a1)}this._updateDocList.call(this,{filter:aT(a1),page:this.currentPage})},null,this);var aU=function aW(a2,a1){a1.widgets.paginator.setState(a2);YAHOO.util.History.navigate("page",String(a2.page))};if(this.options.usePagination){var aZ=YAHOO.util.History.getBookmarkedState("page")||"1";while(aZ!==(aZ=decodeURIComponent(aZ))){}this.currentPage=parseInt(aZ||this.options.initialPage,10);YAHOO.util.History.register("page",aZ,function aX(a1){Alfresco.logger.debug("HistoryManager: page changed:"+a1);if(this.currentPage!==a1){this._updateDocList.call(this,{page:a1})}else{Alfresco.logger.debug("...page changed event ignored.")}},null,this);this.widgets.paginator=new YAHOO.widget.Paginator({containers:[this.id+"-paginator",this.id+"-paginatorBottom"],rowsPerPage:this.options.pageSize,initialPage:this.currentPage,template:this.msg("pagination.template"),pageReportTemplate:this.msg("pagination.template.page-report"),previousPageLinkLabel:this.msg("pagination.previousPageLinkLabel"),nextPageLinkLabel:this.msg("pagination.nextPageLinkLabel")});this.widgets.paginator.subscribe("changeRequest",aU,this);w.setStyle(this.id+"-doclistBarBottom","display","block")}},_setupDataSource:function Y(){var aT=this;this.widgets.dataSource=new YAHOO.util.DataSource(this.dataSourceUrl,{responseType:YAHOO.util.DataSource.TYPE_JSON,responseSchema:{resultsList:"items",metaFields:{paginationRecordOffset:"startIndex",totalRecords:"totalRecords",totalRecordsUpper:"totalRecordsUpper"}}});this.widgets.dataSource.doBeforeCallback=function aS(aW,a7,a9){aT.doclistMetadata=a7.metadata;YAHOO.Bubbling.fire("doclistMetadata",{metadata:aT.doclistMetadata});var a5=null;if(aT.doclistMetadata.parent){a5=aT.doclistMetadata.parent.permissions;if(a5&&a5.user){YAHOO.Bubbling.fire("userAccess",{userAccess:a5.user})}}var aX=aT.doclistMetadata.itemCounts,a3=(aX.documents===0&&aX.folders===0),a4=(aX.documents===0&&!aT.options.showFolders&&aX.folders>0);var a1=function a2(bd){var bb=w.getChildren(bd);for(var ba=0,bc=bb.length;ba<bc;ba++){if(bb[ba].id!==null&&bb[ba].id!==""){bb[ba].id+="-instance"}}};var a8=w.get(aT.id+"-main-template"),a0=a8.cloneNode(true),aV=w.getFirstChild(a0),aZ=null,aU=null;if(a5){var aY=aT.doclistMetadata.parent.permissions.user.CreateChildren&&YAHOO.env.ua.mobile===null;if(aY&&aT.dragAndDropEnabled){w.addClass(aV,"docListInstructionsWithDND")}else{w.addClass(aV,"docListInstructions")}if(a3&&!aY){a8=w.get(aT.id+"-no-items-template");aZ=a8.cloneNode(true);w.removeClass(aZ,"hidden");aV.appendChild(aZ)}else{if(a4){a8=w.get(aT.id+"-hidden-subfolders-template");aZ=a8.cloneNode(true);w.removeClass(aZ,"hidden");a1(aZ);aU=w.getElementsByClassName("docListLinkedInstruction","a",aZ);if(aU.length==1){aU[0].innerHTML=aT.msg("show.folders",aX.folders)}aV.appendChild(aZ)}else{if(a3&&aY&&aT.dragAndDropEnabled){a8=w.get(aT.id+"-dnd-instructions-template");aZ=a8.cloneNode(true);w.removeClass(aZ,"hidden");aV.appendChild(aZ)}else{if(a3&&aY&&!aT.dragAndDropEnabled){a8=w.get(aT.id+"-upload-instructions-template");aZ=a8.cloneNode(true);w.removeClass(aZ,"hidden");a1(aZ);aV.appendChild(aZ)}}}}if(a3&&aY&&aT.dragAndDropEnabled){a8=w.get(aT.id+"-other-options-template");aZ=a8.cloneNode(true);w.removeClass(aZ,"hidden");aV.appendChild(aZ);if(a3&&aY){if(aT.dragAndDropEnabled){a8=w.get(aT.id+"-standard-upload-template");aZ=a8.cloneNode(true);w.removeClass(aZ,"hidden");a1(aZ);aV.appendChild(aZ)}a8=w.get(aT.id+"-new-folder-template");aZ=a8.cloneNode(true);w.removeClass(aZ,"hidden");a1(aZ);aV.appendChild(aZ)}}}else{w.addClass(aV,"docListInstructions");if(a4){a8=w.get(aT.id+"-hidden-subfolders-template");aZ=a8.cloneNode(true);w.removeClass(aZ,"hidden");a1(aZ);aU=w.getElementsByClassName("docListLinkedInstruction","a",aZ);if(aU.length==1){aU[0].innerHTML=aT.msg("show.folders",aX.folders)}aV.appendChild(aZ)}else{a8=w.get(aT.id+"-no-items-template");aZ=a8.cloneNode(true);w.removeClass(aZ,"hidden");aV.appendChild(aZ)}}var a6=document.createElement("div");w.setStyle(a6,"clear","both");aV.appendChild(a6);aT.widgets.dataTable.set("MSG_EMPTY",a0.innerHTML);return a9}},_setupDataTable:function aK(){var aV=this;var aX=[{key:"nodeRef",label:"Select",sortable:false,formatter:this.fnRenderCellSelected(),width:16},{key:"status",label:"Status",sortable:false,formatter:this.fnRenderCellStatus(),width:16},{key:"thumbnail",label:"Preview",sortable:false,formatter:this.fnRenderCellThumbnail(),width:100},{key:"fileName",label:"Description",sortable:false,formatter:this.fnRenderCellDescription()},{key:"actions",label:"Actions",sortable:false,formatter:this.fnRenderCellActions(),width:200}];this.widgets.dataTable=new YAHOO.widget.DataTable(this.id+"-documents",aX,this.widgets.dataSource,{renderLoopSize:this.options.usePagination?16:Alfresco.util.RENDERLOOPSIZE,initialLoad:false,dynamicData:true,MSG_EMPTY:this.msg("message.loading")});this.widgets.dataTable.handleDataReturnPayload=function aU(aZ,aY,a0){aV.totalRecords=aY.meta.totalRecords;aV.totalRecordsUpper=aY.meta.totalRecordsUpper;return aY.meta};this._setDefaultDataTableErrors(this.widgets.dataTable);this.widgets.dataTable.subscribe("tableMsgShowEvent",function(a3){this._elMsgTbody.parentNode.style.width="";if(a3.html&&a3.html.indexOf("docListInstructions")!==-1){var a6=Alfresco.util.ComponentManager.findFirst("Alfresco.DocListToolbar");if(a6!==null){var a4=w.get(aV.id+"-standard-upload-link-template-instance");if(a4!==null){var a7=w.getChildren(a4);I.addListener(a7[0],"click",a6.onFileUpload,a6,true);I.addListener(w.getFirstChild(a7[1]),"click",a6.onFileUpload,a6,true)}var a2=w.get(aV.id+"-new-folder-link-template-instance");if(a2!==null){var a5=w.getChildren(a2);I.addListener(a5[0],"click",a6.onNewFolder,a6,true);I.addListener(w.getFirstChild(a5[1]),"click",a6.onNewFolder,a6,true)}}var aY=w.get(aV.id+"-show-folders-template-instance");if(aY!==null){var a0=function aZ(){this.widgets.showFolders.set("checked",true)};var a1=w.getChildren(aY);I.addListener(a1[0],"click",a0,aV,true);I.addListener(a1[1],"click",a0,aV,true)}}});this.widgets.dataTable.doBeforeLoadData=function aS(a0,a2,a4){if(a2.error){try{var aY=YAHOO.lang.JSON.parse(a2.responseText);aV.widgets.dataTable.set("MSG_ERROR",aY.message)}catch(a3){aV._setDefaultDataTableErrors(aV.widgets.dataTable)}}else{if(a2.results.length===0){this.fireEvent("renderEvent",{type:"renderEvent"})}else{for(var aZ=0,a1=a2.results.length;aZ<a1;aZ++){a2.results[aZ].jsNode=new Alfresco.util.Node(a2.results[aZ].node)}}}return true};this.widgets.dataTable.subscribe("checkboxClickEvent",function aT(aY){var aZ=aY.target.value;this.selectedFiles[aZ]=aY.target.checked;YAHOO.Bubbling.fire("selectedFilesChanged")},this,true);this.widgets.dataTable.subscribe("renderEvent",function aW(){Alfresco.logger.debug("DataTable renderEvent");if(0<YAHOO.env.ua.ie&&YAHOO.env.ua.ie<7){var aZ=this.widgets.dataTable.getTableEl().parentNode;aZ.className=aZ.className}if(this.widgets.paginator){Alfresco.logger.debug("Setting paginator state: page="+this.currentPage+", totalRecords="+this.totalRecords);this.widgets.paginator.setState({page:this.currentPage,totalRecords:this.totalRecords});if(this.totalRecordsUpper){this.widgets.paginator.set("pageReportTemplate",this.msg("pagination.template.page-report.more"))}else{this.widgets.paginator.set("pageReportTemplate",this.msg("pagination.template.page-report"))}this.widgets.paginator.render()}if(this.options.highlightFile){YAHOO.Bubbling.fire("highlightFile",{fileName:window.unescape(this.options.highlightFile)})}else{if(this.listUpdated){var a3=w.getY(this.id+"-documents"),aY=YAHOO.env.ua.ie>0?((document.compatMode&&document.compatMode!=="BackCompat")?document.documentElement:document.body).scrollTop:window.scrollY;if(aY>a3){window.scrollTo(0,a3)}}}var a2,a1;for(a2=0,a1=this.afterDocListUpdate.length;a2<a1;a2++){this.afterDocListUpdate[a2].call(this)}this.afterDocListUpdate=[];this.widgets.previewTooltip.cfg.setProperty("context",this.previewTooltips);var a0;for(a2=0,a1=this.insituEditors.length;a2<a1;a2++){a0=this.insituEditors[a2];Alfresco.util.createInsituEditor(a0.context,a0.params,a0.callback)}this.widgets.dataTable.set("renderLoopSize",this.options.usePagination?16:Alfresco.util.RENDERLOOPSIZE)},this,true);this.widgets.dataTable.subscribe("rowMouseoverEvent",this.onEventHighlightRow,this,true);this.widgets.dataTable.subscribe("rowMouseoutEvent",this.onEventUnhighlightRow,this,true);if(this.dragAndDropEnabled){I.addListener(document.body,"dragenter",this._swallowDragEnter,this,true);I.addListener(document.body,"dragover",this._swallowDragOver,this,true);I.addListener(document.body,"drop",this._swallowDragDrop,this,true);I.addListener(document.body,"dragstart",this._swallowDragStart,this,true)}},_removeDragAndDrop:function an(){if(this.dragAndDropEnabled){try{var aT=w.get(this.id+"-body");I.removeListener(aT,"dragenter");I.removeListener(aT,"dragover");I.removeListener(aT,"dragleave");I.removeListener(aT,"drop")}catch(aS){Alfresco.logger.error("_addDragAndDrop: The following exception occurred: ",aS)}}},_addDragAndDrop:function C(){if(this.dragAndDropEnabled){try{var aT=w.get(this.id+"-body");I.addListener(aT,"dragenter",this.onDocumentListDragEnter,this,true);I.addListener(aT,"dragover",this.onDocumentListDragOver,this,true);I.addListener(aT,"dragleave",this.onDocumentListDragLeave,this,true);I.addListener(aT,"drop",this.onDocumentListDrop,this,true)}catch(aS){Alfresco.logger.error("_addDragAndDrop: The following exception occurred: ",aS)}}},_swallowDragStart:function p(aS){aS.stopPropagation();aS.preventDefault()},_swallowDragEnter:function q(aS){aS.stopPropagation();aS.preventDefault()},_swallowDragOver:function aa(aS){aS.dataTransfer.dropEffect="none";aS.stopPropagation();aS.preventDefault()},_swallowDrop:function ar(aS){aS.stopPropagation();aS.preventDefault()},onDocumentListDragEnter:function aj(aX){var aT=aX.target,aV=this.widgets.dataTable.getRecord(aT),aS=this.widgets.dataTable.getColumn(aT),aW=this.widgets.dataTable.getContainerEl(),aU;if(aV&&aS&&(aT.tagName=="IMG"||aT.className=="droppable")&&aS.getKey()=="thumbnail"){aU=aV.getData("jsNode");if(aU&&aU.isContainer){this.dragFolderHighlight=w.getAncestorByClassName(aT,"folder");w.addClass(this.dragFolderHighlight,"dndFolderHighlight");w.removeClass(aW,"dndDocListHighlight")}}else{this.dragEventRefCount=Math.min(++this.dragEventRefCount,2);w.addClass(aW,"dndDocListHighlight");if(this.dragFolderHighlight){w.removeClass(this.dragFolderHighlight,"dndFolderHighlight");this.dragFolderHighlight=null}}aX.stopPropagation();aX.preventDefault()},onDocumentListDragOver:function j(aS){aS.dataTransfer.dropEffect=Math.floor(YAHOO.env.ua.gecko)===1?"move":"copy";aS.stopPropagation();aS.preventDefault()},onDocumentListDragLeave:function aP(aW){var aT=aW.target,aU=this.widgets.dataTable.getRecord(aT),aV=this.widgets.dataTable.getColumn(aT),aS=aU?aU.getData():null;if(aU&&aV&&(aT.tagName=="IMG"||aT.className=="droppable")&&aS.node.isContainer&&aV.getKey()=="thumbnail"){}else{if(--this.dragEventRefCount===0){w.removeClass(this.widgets.dataTable.getContainerEl(),"dndDocListHighlight")}}aW.stopPropagation();aW.preventDefault()},onDocumentListDrop:function ac(a2){try{if(a2.dataTransfer.files!==undefined&&a2.dataTransfer.files!==null&&a2.dataTransfer.files.length>0){var aZ=Alfresco.getDNDUploadProgressInstance();var aT=false;var a3="",aW,aV;aV=a2.dataTransfer.files.length;for(aW=0;aW<aV;aW++){if(a2.dataTransfer.files[aW].size>0){aT=true}else{a3+='"'+a2.dataTransfer.files[aW].fileName+'", '}}if(!aT){a3=a3.substring(0,a3.lastIndexOf(", "));Alfresco.util.PopupManager.displayMessage({text:aZ.msg("message.zeroByteFiles",a3)})}if(aT&&aZ.uploadMethod===aZ.INMEMORY_UPLOAD){var a6=0;aV=a2.dataTransfer.files.length;for(aW=0;aW<aV;aW++){a6+=a2.dataTransfer.files[aW].size}if(a6>aZ.getInMemoryLimit()){aT=false;Alfresco.util.PopupManager.displayPrompt({text:aZ.msg("inmemory.uploadsize.exceeded",Alfresco.util.formatFileSize(aZ.getInMemoryLimit()))})}}if(aT){var a1=this.currentPath,aS=a1.substring(a1.lastIndexOf("/")+1),a4=this.doclistMetadata.parent?this.doclistMetadata.parent.nodeRef:null;var a7=this.widgets.dataTable.getRecord(a2.target);if(a7!==null){var a0=this.widgets.dataTable.getColumn(a2.target),aY=a7.getData();if(a7&&a0&&a2.target.tagName=="IMG"&&aY.node.isContainer&&a0.getKey()=="thumbnail"){var a5=aY.location;aS=a5.file;a1=aA(a5.path,a5.file);a4=aY.nodeRef}}w.removeClass(this.widgets.dataTable.getTrEl(a2.target),"dndFolderHighlight");w.removeClass(this.widgets.dataTable.getContainerEl(),"dndDocListHighlight");var aX={files:a2.dataTransfer.files,uploadDirectoryName:aS,filter:[],mode:aZ.MODE_MULTI_UPLOAD,thumbnails:"doclib",onFileUploadComplete:{fn:this.onFileUploadComplete,scope:this}};if(A(this.options.siteId)){aX.siteId=this.options.siteId;aX.containerId=this.options.containerId;aX.uploadDirectory=a1}else{aX.destination=a4}aZ.show(aX)}}else{Alfresco.logger.debug("DL_onDocumentListDrop: A drop event was detected, but no files were present for upload: ",a2.dataTransfer)}}catch(aU){Alfresco.logger.error("DL_onDocumentListDrop: The following error occurred when files were dropped onto the Document List: ",aU)}a2.stopPropagation();a2.preventDefault()},onHistoryManagerReady:function u(){if(this.options.initialFilter.filterId==="path"&&window.location.hash=="#upload"){window.location.hash="";var aS=function aT(){YAHOO.Bubbling.fire("showFileUploadDialog",{tooltip:this.msg("dnd.upload.tooltip")})};this.afterDocListUpdate.push(aS)}Alfresco.logger.debug("DL_onHistoryManagerReady","changeFilter =>",this.options.initialFilter);YAHOO.Bubbling.fire("changeFilter",YAHOO.lang.merge({doclistFirstTimeNav:true},this.options.initialFilter));w.setStyle(this.id+"-body","visibility","visible")},getSelectedFiles:function aR(){var aW=[],aX=this.widgets.dataTable.getRecordSet(),aV,aU,aT,aS;for(aT=0,aS=aX.getLength();aT<aS;aT++){aV=aX.getRecord(aT);aU=aV.getData("node");if(this.selectedFiles[aU.nodeRef]){aW.push(aV.getData())}}return aW},selectFiles:function v(a2){var aZ=this.widgets.dataTable.getRecordSet(),aU=YAHOO.util.Selector.query('input[type="checkbox"]',this.widgets.dataTable.getTbodyEl()),aY=aU.length,a4,aW,aV,a3;switch(a2){case"selectAll":a3=function a0(a5,a6){return true};break;case"selectNone":a3=function aX(a5,a6){return false};break;case"selectInvert":a3=function aT(a5,a6){return !a6};break;case"selectDocuments":a3=function aS(a5,a6){return !(a5.node.isContainer)};break;case"selectFolders":a3=function aS(a5,a6){return a5.node.isContainer};break;default:a3=function a1(a5,a6){return a6}}for(aV=0;aV<aY;aV++){a4=aZ.getRecord(aV);aW=a4.getData();this.selectedFiles[aW.nodeRef]=aU[aV].checked=a3(aW,aU[aV].checked)}YAHOO.Bubbling.fire("selectedFilesChanged")},onSortAscending:function S(aS,aT){this.options.sortAscending=!this.options.sortAscending;this.widgets.sortAscending.set("title",this.msg(this.options.sortAscending?"button.sort.descending":"button.sort.ascending"));if(this.options.sortAscending){w.removeClass(this.widgets.sortAscending.get("element"),"sort-descending")}else{w.addClass(this.widgets.sortAscending.get("element"),"sort-descending")}this.services.preferences.set(ax,this.options.sortAscending);YAHOO.Bubbling.fire("metadataRefresh");if(aS){I.preventDefault(aS)}},onSortField:function aH(aX,aW,aV){var aS=aW[0],aT=aW[1];if(aT){this.options.sortField=aT.value;this.widgets.sortField.set("label",aT.cfg.getProperty("text"));this.services.preferences.set(d,this.options.sortField);var aU=aT.srcElement.getAttribute("title");if(aU==="true"||aU==="false"){this.options.sortAscending=(aU==="false");this.onSortAscending()}else{YAHOO.Bubbling.fire("metadataRefresh")}}I.preventDefault(aS)},onShowFolders:function h(aS,aT){this.options.showFolders=this.widgets.showFolders.get("checked");this.widgets.showFolders.set("title",this.msg(this.options.showFolders?"button.folders.hide":"button.folders.show"));this.services.preferences.set(T,this.options.showFolders);YAHOO.Bubbling.fire("metadataRefresh");if(aS){I.preventDefault(aS)}},onViewRendererSelect:function aQ(aS,aT){this.options.viewRendererName=this.options.viewRendererNames[aS.newValue.index];this.services.preferences.set(V,this.options.viewRendererName);if(this.options.simpleView!=null){this.services.preferences.set(M,null);this.options.simpleView=null}YAHOO.Bubbling.fire("metadataRefresh");if(aS){I.preventDefault(aS)}},onFileSelect:function c(aW,aV,aU){var aS=aV[0],aT=aV[1];this.selectFiles(Alfresco.util.findEventClass(aT));I.preventDefault(aS)},onEventHighlightRow:function W(aV){this.widgets.dataTable.onEventHighlightRow.call(this.widgets.dataTable,aV);var aU=w.get(this.id+"-actions-"+aV.target.id);if(aU&&aU.firstChild===null){var a7=this.widgets.dataTable.getRecord(aV.target.id),a2=a7.getData(),aS=a2.jsNode,aX=a2.actions,aY=document.createElement("div"),a4="",a1;a2.actionParams={};for(var a0=0,a6=aX.length;a0<a6;a0++){a4+=this.renderAction(aX[a0],a2)}aY.innerHTML=YAHOO.lang.substitute(a4,this.getActionUrls(a2));w.addClass(aY,"action-set");var aZ="simple";if(typeof this.viewRenderers[this.options.viewRendererName]==="object"){aZ=this.viewRenderers[this.options.viewRendererName].actionsCssClassName}w.addClass(aY,aZ);a1=YAHOO.util.Selector.query("div",aY);if(a1.length>this.options.actionsSplitAt+(this.options.viewRendererName=="simple"?0:1)){var aW=w.get(this.id+"-moreActions").cloneNode(true),a5=YAHOO.util.Selector.query("div",aW);w.insertBefore(a5[0],a1[this.options.actionsSplitAt]);w.insertBefore(a5[1],a1[this.options.actionsSplitAt]);var a3,aT=a1.slice(this.options.actionsSplitAt);for(a3 in aT){if(aT.hasOwnProperty(a3)){a5[1].appendChild(aT[a3])}}}aU.appendChild(aY)}if(this.showingMoreActions){this.deferredActionsMenu=aU}else{if(!w.hasClass(document.body,"masked")){this.currentActionsMenu=aU;w.removeClass(aU,"hidden");this.deferredActionsMenu=null}}},onEventUnhighlightRow:function E(aT){this.widgets.dataTable.onEventUnhighlightRow.call(this.widgets.dataTable,aT);var aS=w.get(this.id+"-actions-"+(aT.target.id));if((aS&&!this.showingMoreActions)||w.hasClass(document.body,"masked")){w.addClass(aS,"hidden");this.deferredActionsMenu=null}},onActionShowMore:function z(aT,aW){var aY=this;w.addClass(aW.firstChild,"highlighted");var a1=w.getNextSibling(aW);w.removeClass(a1,"hidden");aY.showingMoreActions=true;var a0=function aZ(){I.removeListener(a1,"mouseover");I.removeListener(a1,"mouseout");w.removeClass(aW.firstChild,"highlighted");w.addClass(a1,"hidden");aY.showingMoreActions=false;if(aY.deferredActionsMenu!==null){w.addClass(aY.currentActionsMenu,"hidden");aY.currentActionsMenu=aY.deferredActionsMenu;aY.deferredActionsMenu=null;w.removeClass(aY.currentActionsMenu,"hidden")}};if(a1.hideTimerId){window.clearTimeout(a1.hideTimerId)}a1.hideTimerId=window.setTimeout(a0,aY.options.actionsPopupTimeout*4);var aU=function aS(a3,a2){if(a2.hideTimerId){window.clearTimeout(a2.hideTimerId);a2.hideTimerId=null}};var aX=function aV(a4,a3){var a5=I.getTarget(a4);var a2=a5.relatedTarget;if((a2!==a3)&&(!w.isAncestor(a3,a2))){if(a3.hideTimerId){window.clearTimeout(a3.hideTimerId)}a3.hideTimerId=window.setTimeout(a0,aY.options.actionsPopupTimeout)}};I.on(a1,"mouseover",aU,a1);I.on(a1,"mouseout",aX,a1)},onActionEditOffline:function N(aU){if(!this.state.actionEditOfflineActive){this.state.actionEditOfflineActive=true;var aV=aU.jsNode.nodeRef,aT=aU.displayName;this.modules.actions.genericAction({success:{event:{name:"metadataRefresh"},callback:{fn:function aW(aZ){this.state.actionEditOfflineActive=false;this.options.highlightFile=aT;var aY=function aX(){var a2=Alfresco.constants.PROXY_URI+aZ.json.results[0].downloadUrl;if(YAHOO.env.ua.ie>6){Alfresco.util.PopupManager.displayPrompt({title:this.msg("message.edit-offline.success",aT),text:this.msg("message.edit-offline.success.ie7"),buttons:[{text:this.msg("button.download"),handler:function a1(){window.location=a2;this.destroy()},isDefault:true},{text:this.msg("button.close"),handler:function a0(){this.destroy()}}]})}else{Alfresco.util.PopupManager.displayMessage({text:this.msg("message.edit-offline.success",aT)});YAHOO.lang.later(3000,this,function(){window.location=a2})}};this.afterDocListUpdate.push(aY)},scope:this}},failure:{callback:{fn:function aS(){this.state.actionEditOfflineActive=false},scope:this},message:this.msg("message.edit-offline.failure",aT)},webscript:{method:Alfresco.util.Ajax.POST,name:"checkout/node/{nodeRef}",params:{nodeRef:aV.uri}}})}},onActionCheckoutToGoogleDocs:function aG(aU){var aT=aU.displayName,aW=aU.jsNode.nodeRef,aX=aU.location.path,aZ=aU.fileName;var aY=Alfresco.util.PopupManager.displayMessage({displayTime:0,effect:null,text:this.msg("message.checkout-google.inprogress",aT)});this.modules.actions.genericAction({success:{event:{name:"changeFilter",obj:{filterId:"editingMe"}},callback:{fn:function aS(a2){aY.destroy();this.options.highlightFile=aT;var a0=function a1(){Alfresco.util.PopupManager.displayMessage({text:this.msg("message.checkout-google.success",aT)})};this.afterDocListUpdate.push(a0)},scope:this},activity:{siteId:this.options.siteId,activityType:"google-docs-checkout",page:"document-details",activityData:{fileName:aZ,path:aX,nodeRef:aW.toString()}}},failure:{callback:{fn:function aV(a0){aY.destroy();Alfresco.util.PopupManager.displayMessage({text:this.msg("message.checkout-google.failure",aT)})},scope:this}},webscript:{method:Alfresco.util.Ajax.POST,name:"checkout/node/{nodeRef}",params:{nodeRef:aW.uri}}})},onActionCheckinFromGoogleDocs:function k(aU){var aT=aU.displayName,aV=aU.jsNode.nodeRef,aS=new Alfresco.util.NodeRef(aU.workingCopy.sourceNodeRef),aW=aU.location.path;var aY=Alfresco.util.PopupManager.displayMessage({displayTime:0,effect:null,text:this.msg("message.checkin-google.inprogress",aT)});this.modules.actions.genericAction({success:{event:{name:"metadataRefresh"},callback:{fn:function aX(a1){aY.destroy();var aZ=function a0(){Alfresco.util.PopupManager.displayMessage({text:this.msg("message.checkin-google.success",aT)})};this.afterDocListUpdate.push(aZ)},scope:this},activity:{siteId:this.options.siteId,activityType:"google-docs-checkin",page:"document-details",activityData:{fileName:aT,path:aW,nodeRef:aS.toString()}}},failure:{message:this.msg("message.checkin-google.failure",aT)},webscript:{method:Alfresco.util.Ajax.POST,name:"checkin/node/{nodeRef}",params:{nodeRef:aV.uri}}})},onFileAction:function aw(aT,aS){var aU=aS[1];if(aU){if(!aU.multiple){this._updateDocList.call(this)}}},onFileRenamed:function F(aT,aS){var aW=aS[1];if(aW&&(aW.file!==null)){var aV=this._findRecordByParameter(aW.file.node.nodeRef,"nodeRef");if(aV!==null){this.widgets.dataTable.updateRow(aV,aW.file);var aU=this.widgets.dataTable.getTrEl(aV);Alfresco.util.Anim.pulse(aU)}}},onDocListRefresh:function ab(aT,aS){var aU=aS[1];if(aU&&(aU.highlightFile!==null)){this.options.highlightFile=aU.highlightFile}this._updateDocList.call(this)},onChangeFilter:function D(aU,aT){var aX=aT[1];if((aX!==null)&&(aX.filterId!==null)){var aW=Alfresco.util.cleanBubblingObject(aX),aV=window.escape(aX.filterId)+(typeof aX.filterData!=="undefined"?"|"+window.escape(aX.filterData)+(typeof aX.filterDisplay!=="undefined"?"|"+window.escape(aX.filterDisplay):""):"");Alfresco.logger.debug("DL_onChangeFilter: ",aW);this._removeDragAndDrop();if(aX.filterId==="path"){this._addDragAndDrop()}this.listUpdated=true;var aS={filter:aV};if(aX.doclistFirstTimeNav){this._updateDocList.call(this,{filter:aW,page:this.currentPage})}else{if(this.options.usePagination){this.currentPage=1;aS.page="1"}Alfresco.logger.debug("DL_onChangeFilter: objNav = ",aS);if(this.options.highlightFile&&aS.filter===YAHOO.util.History.getCurrentState("filter")){YAHOO.Bubbling.fire("highlightFile",{fileName:this.options.highlightFile})}YAHOO.util.History.multiNavigate(aS)}}},onFilterChanged:function t(aT,aS){var aU=aS[1];if((aU!==null)&&(aU.filterId!==null)){aU.filterOwner=aU.filterOwner||Alfresco.util.FilterManager.getOwner(aU.filterId);this.currentFilter=Alfresco.util.cleanBubblingObject(aU);Alfresco.logger.debug("DL_onFilterChanged: ",this.currentFilter)}},onHighlightFile:function ad(aT,aS){var aX=aS[1];if((aX!==null)&&(A(aX.fileName))){Alfresco.logger.debug("DL_onHighlightFile: ",aX.fileName);var aW=this._findRecordByParameter(aX.fileName,"displayName");if(aW!==null){var aU=this.widgets.dataTable.getTrEl(aW),aV=w.getY(aU);if(YAHOO.env.ua.ie>0){aV=aV-(document.body.clientHeight/3)}else{aV=aV-(window.innerHeight/3)}window.scrollTo(0,aV);Alfresco.util.Anim.pulse(aU);this.options.highlightFile=null;w.get("checkbox-"+aW.getId()).checked=true;this.selectedFiles[aW.getData("nodeRef")]=true;YAHOO.Bubbling.fire("selectedFilesChanged")}}},onDeactivateAllControls:function R(aU,aT){var aS,aV=Alfresco.util.disableYUIButton;for(aS in this.widgets){if(this.widgets.hasOwnProperty(aS)){aV(this.widgets[aS])}}},onDeactivateDynamicControls:function am(aU,aT){var aS,aV=Alfresco.util.disableYUIButton;for(aS in this.dynamicControls){if(this.dynamicControls.hasOwnProperty(aS)){aV(this.dynamicControls[aS])}}},onActivateDynamicControls:function B(aU,aT){var aS,aV=Alfresco.util.enableYUIButton;for(aS in this.dynamicControls){if(this.dynamicControls.hasOwnProperty(aS)){aV(this.dynamicControls[aS])}}},onLikes:function y(aY){var aX=this.widgets.dataTable.getRecord(aY),aS=aX.getData(),aW=aS.jsNode.nodeRef,aT=aS.likes;aT.isLiked=!aT.isLiked;aT.totalLikes+=(aT.isLiked?1:-1);var aU={successCallback:{fn:function aZ(a6,a3){var a7=a6.json.data;if(a7){var a5=this._findRecordByParameter(a3,"nodeRef"),a0=a5.getData(),a4=a0.node,a1=a0.likes;a1.totalLikes=a7.ratingsCount;this.widgets.dataTable.updateRow(a5,a0);if(a1.isLiked){var a2={fileName:a0.fileName,nodeRef:a4.nodeRef};if(a4.isContainer){this.modules.actions.postActivity(this.options.siteId,"folder-liked","folder-details",a2)}else{this.modules.actions.postActivity(this.options.siteId,"file-liked","document-details",a2)}}}},scope:this,obj:aW.toString()},failureCallback:{fn:function aV(a4,a2){var a3=this._findRecordByParameter(a2,"nodeRef"),a0=a3.getData(),a1=a0.likes;a1.isLiked=!a1.isLiked;a1.totalLikes+=(a1.isLiked?1:-1);this.widgets.dataTable.updateRow(a3,a0);Alfresco.util.PopupManager.displayPrompt({text:this.msg("message.save.failure",a0.displayName)})},scope:this,obj:aW.toString()}};if(aT.isLiked){this.services.likes.set(aW,1,aU)}else{this.services.likes.remove(aW,aU)}this.widgets.dataTable.updateRow(aX,aS)},onFavourite:function at(aY){var aZ=this.widgets.dataTable.getRecord(aY),aW=aZ.getData(),aV=aW.node,aX=aV.nodeRef;aW.isFavourite=!aW.isFavourite;this.widgets.dataTable.updateRow(aZ,aW);var a0={failureCallback:{fn:function aS(a5,a1){var a4=this.widgets.dataTable.getRecord(a1),a2=a4.getData(),a3=a2.node;a2.isFavourite=!a2.isFavourite;this.widgets.dataTable.updateRow(a4,a2);Alfresco.util.PopupManager.displayPrompt({text:this.msg("message.save.failure",a2.displayName)})},scope:this,obj:aY}};var aT=aW.isFavourite?"add":"remove",aU=aV.isContainer?Alfresco.service.Preferences.FAVOURITE_FOLDERS:Alfresco.service.Preferences.FAVOURITE_DOCUMENTS;this.services.preferences[aT].call(this.services.preferences,aU,aX,a0)},_setDefaultDataTableErrors:function e(aS){var aT=Alfresco.util.message;aS.set("MSG_EMPTY",aT("message.empty","Alfresco.DocumentList"));aS.set("MSG_ERROR",aT("message.error","Alfresco.DocumentList"))},_updateDocList:function az(a5){a5=a5||{};Alfresco.logger.debug("DL__updateDocList: ",a5.filter,a5.page);var a7=YAHOO.lang.merge({doclistFirstTimeNav:false},a5.filter!==undefined?a5.filter:this.currentFilter),aT=a5.page!==undefined?a5.page:this.currentPage,a1=null,aX=null,a3=this,aV={filter:a7,page:aT};var aY=function a2(){Alfresco.logger.debug("DL__uDL_fnShowLoadingMessage: slow data webscript detected.");if(aX){a1=Alfresco.util.PopupManager.displayMessage({displayTime:0,text:'<span class="wait">'+f(this.msg("message.loading"))+"</span>",noEscape:true});if(YAHOO.env.ua.ie>0){this.loadingMessageShowing=true}else{a1.showEvent.subscribe(function(){this.loadingMessageShowing=true},this,true)}}};this._setDefaultDataTableErrors(this.widgets.dataTable);this.previewTooltips=[];this.insituEditors=[];this.showingMoreActions=false;this.loadingMessageShowing=false;aX=YAHOO.lang.later(this.options.loadingMessageDelay,this,aY);var a6=function aZ(){if(aX){aX.cancel();aX=null}if(a1){if(this.loadingMessageShowing){a1.destroy();a1=null}else{YAHOO.lang.later(100,a3,a6)}}};var a0=function aU(bb,bd,be){a6();var a8=function a9(){YAHOO.Bubbling.fire("activateDynamicControls");YAHOO.Bubbling.fire("selectedFilesChanged");this.listUpdated=false};this.afterDocListUpdate.push(a8);Alfresco.logger.debug("currentFilter was:",this.currentFilter,"now:",a7);Alfresco.logger.debug("currentPage was ["+this.currentPage+"] now ["+aT+"]");this.currentFilter=a7;this.currentPage=aT;if(a7.filterId==="path"){Alfresco.logger.debug("currentPath was ["+this.currentPath+"] now ["+a7.filterData+"]");this.currentPath=a7.filterData}delete a7.doclistFirstTimeNav;YAHOO.Bubbling.fire("filterChanged",a7);for(var ba=0,bc=this.options.viewRendererNames.length;ba<bc;ba++){this.viewRenderers[this.options.viewRendererNames[ba]].destroyView(this,bb,bd,be)}this.viewRenderers[this.options.viewRendererName].renderView(this,bb,bd,be)};var aS=function aW(a8,a9){a6();this.afterDocListUpdate=[];if(a9.status===401){window.location.reload(true)}else{try{if(a9.status===404){YAHOO.Bubbling.fire("deactivateDynamicControls")}else{YAHOO.Bubbling.fire("deactivateAllControls")}var bc=function ba(be){return function bd(){this.widgets.paginator.setState({totalRecords:0});this.widgets.paginator.render();this.widgets.dataTable.set("MSG_ERROR",be);this.widgets.dataTable.showTableMessage(be,YAHOO.widget.DataTable.CLASS_ERROR)}};this.afterDocListUpdate.push(bc(YAHOO.lang.JSON.parse(a9.responseText).message));this.widgets.dataTable.initializeTable();this.widgets.dataTable.render();this.listUpdated=false}catch(bb){Alfresco.logger.error(bb);this._setDefaultDataTableErrors(this.widgets.dataTable)}}};if(aV.filter&&aV.filter.filterId==="path"){aV.path=aV.filter.filterData}var a4=this._buildDocListParams(aV);Alfresco.logger.debug("DataSource requestParams: ",a4);this.widgets.dataSource.sendRequest(a4,{success:a0,failure:aS,scope:this})},_buildDocListParams:function a(aW){var aT=A(this.options.siteId),aU={path:this.currentPath,type:this.options.showFolders?"all":"documents",site:this.options.siteId,container:this.options.containerId,filter:this.currentFilter};if(this.options.usePagination){aU.page=this.widgets.paginator.getCurrentPage()||this.currentPage;aU.pageSize=this.widgets.paginator.getRowsPerPage()}if(typeof aW==="object"){aU=YAHOO.lang.merge(aU,aW)}var aS=aT?"site/{site}/{container}":"node/alfresco/company/home",aV=YAHOO.lang.substitute("{type}/"+aS+(aU.filter.filterId==="path"?"{path}":""),{type:encodeURIComponent(aU.type),site:encodeURIComponent(aU.site),container:encodeURIComponent(aU.container),path:aA("/",Alfresco.util.encodeURIPath(aU.path).replace(/%25/g,"%2525"))});aV+="?filter="+encodeURIComponent(aU.filter.filterId);if(aU.filter.filterData&&aU.filter.filterId!=="path"){aV+="&filterData="+encodeURIComponent(aU.filter.filterData)}if(this.options.usePagination){aV+="&size="+aU.pageSize+"&pos="+aU.page}aV+="&sortAsc="+this.options.sortAscending+"&sortField="+encodeURIComponent(this.options.sortField);if(!aT){aV+="&libraryRoot="+encodeURIComponent(this.options.rootNode.toString())}aV+="&view="+this.actionsView+"&noCache="+new Date().getTime();return aV},_findRecordByParameter:function aC(aY,aX){var aW=this.widgets.dataTable.getRecordSet(),aV,aS,aU,aT;for(aU=0,aT=aW.getLength();aU<aT;aU++){aV=aW.getRecord(aU);aS=aV.getData();if(aS[aX]===aY||(aS.node&&aS.node[aX]===aY)){return aV}}return null}},true)})();